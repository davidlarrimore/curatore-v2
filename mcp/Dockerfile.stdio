# MCP STDIO Server for Claude Desktop
#
# This image runs an MCP server that communicates via stdin/stdout,
# designed to be launched by Claude Desktop.
#
# Build:
#   docker build -f Dockerfile.stdio -t curatore-mcp-stdio .
#
# Run:
#   docker run --rm -i --network curatore-v2_default \
#     -e BACKEND_URL=http://backend:8000 \
#     curatore-mcp-stdio
#
# Claude Desktop config:
#   {
#     "mcpServers": {
#       "curatore": {
#         "command": "docker",
#         "args": ["run", "--rm", "-i", "--network", "curatore-v2_default",
#                  "-e", "BACKEND_URL=http://backend:8000", "curatore-mcp-stdio"]
#       }
#     }
#   }

FROM python:3.12-slim

WORKDIR /app

# Install dependencies
RUN pip install --no-cache-dir httpx

# Copy server
COPY stdio_server.py /app/

# Environment defaults
ENV BACKEND_URL=http://backend:8000
ENV LOG_LEVEL=WARNING

# Run the STDIO server
# Note: No EXPOSE needed - communication is via stdin/stdout
CMD ["python", "-u", "stdio_server.py"]
